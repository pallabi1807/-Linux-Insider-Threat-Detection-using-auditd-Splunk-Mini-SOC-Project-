#
# auditd.conf - Reference configuration file for Auditd
# Included in the Linux Insider Threat Detection project
# Maintains logs for Splunk ingestion and stable auditd performance
#

log_file = /var/log/audit/audit.log
log_format = RAW

# Max log file size before rotation (6 MB is standard)
max_log_file = 6

# Action to take when max size is reached
# rotate = rotate logs automatically
max_log_file_action = ROTATE

# Number of log files to keep
num_logs = 5

# Enable flushing to prevent data loss
flush = INCREMENTAL_ASYNC

# Fail mode determines what happens when auditd fails
# 0 = silent, 1 = print error, 2 = panic (recommended for security)
failure_mode = 1

# Buffer size for audit events (increase for high activity systems)
dispatcher = /sbin/audispd
name_format = HOSTNAME

# Priority of audit messages
priority_boost = 4

# Disable space warnings (optional)
space_left = 75
space_left_action = SYSLOG

admin_space_left = 50
admin_space_left_action = SUSPEND

# Stop logging when disk almost full
disk_full_action = SUSPEND
disk_error_action = SUSPEND
